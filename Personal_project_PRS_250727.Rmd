---
title: "Personal_project_PRS"
author: "Heeduk Oh"
date: "`r Sys.Date()`"
output: html_document
---

```{r}
# # import all chr 1-22
# for (i in 1:22) {
#     chr <- i
#     prs_chr <- read.table(paste("D:/GoogleDrive/Personal project/PRS/GWASsummarystats/Asthma_Demenais-et-al/PRS_results/1kgp_chr", chr, "_asthmaPRS.profile", sep=""), header=TRUE)
#     prs_chr$Chr <- chr
#     if(i == 1) {
#         prs <- prs_chr
#     } else {
#         prs <- rbind(prs, prs_chr)
#     }
# }

prs <- read.table("D:/GoogleDrive/Personal project/PRS-asthma/GWASsummarystats/Asthma_Demenais-et-al/PRS_results/1kgp_allchr_asthmaPRS.profile", header=TRUE)

head(prs)
tail(prs)

dim(prs)
```

```{r}
pop_info <- read.table("D:/GoogleDrive/Personal project/PRS-asthma/1KGP/integrated_call_samples_v3.20130502.ALL.panel", header=TRUE)
head(pop_info)

geno_pop <- merge(prs, pop_info, by.x="IID", by.y="sample")
head(geno_pop)
tail(geno_pop)
```

```{r}
hist(geno_pop$SCORESUM, breaks=50, main="PRS Score Distribution for Asthma (1000 Genomes)", xlab="PRS Score")
```

```{r}
summary(geno_pop$SCORESUM)
```


```{r}
# reorder by SCORESUM
geno_pop <- geno_pop[order(geno_pop$SCORESUM, decreasing=TRUE),]

# population of top 5%
table(head(geno_pop, n=ceiling(nrow(geno_pop)*0.05))$super_pop)
```

Plot distribution of PRS scores by ancestry group
```{r}
library(ggplot2)
ggplot(geno_pop, aes(x=super_pop, y=SCORESUM, fill=super_pop)) +
  geom_violin(trim=FALSE) +
  geom_boxplot(width=0.1, fill="white") +
  theme_minimal() +
  labs(title="PRS Scores by 1000 Genomes Ancestry Group", x="Ancestry Group", y="PRS Score") +
  theme(legend.position = "none")

# save as jpeg
png("D:/GoogleDrive/Personal project/PRS-asthma/Images/PRS_scores_by_1000_Genomes_ancestry_group.png", width=6, height=4, units = "in", res = 300)
ggplot(geno_pop, aes(x=super_pop, y=SCORESUM, fill=super_pop)) +
  geom_violin(trim=FALSE) +
  geom_boxplot(width=0.1, fill="white") +
  theme_minimal() +
  labs(x="Ancestry Group", y="PRS Score") +
  theme(legend.position = "none")
dev.off()
```

Plot distribution by gender

```{r}
ggplot(geno_pop, aes(x=gender, y=SCORESUM, fill=gender)) +
  geom_violin(trim=FALSE) +
  geom_boxplot(width=0.1, fill="white") +
  theme_minimal() +
  labs(title="PRS Scores by Gender", x="Gender", y="PRS Score") +
  theme(legend.position = "none")

# save as jpeg
png("D:/GoogleDrive/Personal project/PRS-asthma/Images/PRS_scores_by_gender.png", width=4, height=4, units = "in", res = 300)
ggplot(geno_pop, aes(x=gender, y=SCORESUM, fill=gender)) +
  geom_violin(trim=FALSE) +
  geom_boxplot(width=0.1, fill="white") +
  theme_minimal() +
  labs(x="Gender", y="PRS Score") +
  theme(legend.position = "none")
dev.off()
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
